@import '../style/mixins.scss';

// #variables
:root,
page {
  --sar-upload-preview-width: 80px;
  --sar-upload-preview-height: 80px;
  --sar-upload-preview-gap: 8px;
  --sar-upload-preview-border-radius: var(--sar-rounded);
  --sar-upload-preview-bg: var(--sar-secondary-bg);

  --sar-upload-file-color: var(--sar-body-color);
  --sar-upload-file-icon-font-size: 20px;
  --sar-upload-file-name-margin-top: 5px;
  --sar-upload-file-name-padding-x: 5px;
  --sar-upload-file-name-font-size: var(--sar-text-sm);

  --sar-upload-status-color: var(--sar-white);
  --sar-upload-status-bg: var(--sar-mask-illegible);
  --sar-upload-status-icon-font-size: 20px;
  --sar-upload-status-message-margin-top: 5px;
  --sar-upload-status-message-padding-x: 5px;
  --sar-upload-status-message-font-size: var(--sar-text-sm);

  --sar-upload-close-top: 2px;
  --sar-upload-close-right: 2px;
  --sar-upload-close-width: 20px;
  --sar-upload-close-height: 20px;
  --sar-upload-close-font-size: var(--sar-text-sm);
  --sar-upload-close-color: var(--sar-white);
  --sar-upload-close-bg: var(--sar-mask-illegible);

  --sar-upload-select-width: 80px;
  --sar-upload-select-height: 80px;
  --sar-upload-select-font-size: 24px;
  --sar-upload-select-color: var(--sar-secondary-color);
  --sar-upload-select-border-radius: var(--sar-rounded);
  --sar-upload-select-bg: var(--sar-secondary-bg);
  --sar-upload-select-active-bg: var(--sar-gray-300);

  --sar-upload-video-play-bg: var(--sar-mask-legible);
  --sar-upload-video-play-color: rgba(255, 255, 255, 0.8);

  --sar-upload-loading-size: 20px;
}

@media (prefers-color-scheme: dark) {
  :root,
  page {
    --sar-upload-select-active-bg: var(--sar-gray-600);
  }
}
// #endvariables

.sar-upload {
  display: block;

  @at-root {
    .sar-upload-wrapper {
      display: flex;
      flex-wrap: wrap;
      gap: var(--sar-upload-preview-gap);
    }
  }
}

.sar-upload-preview {
  position: relative;
  width: var(--sar-upload-preview-width);
  height: var(--sar-upload-preview-height);
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
  border-radius: var(--sar-upload-preview-border-radius);
  background-color: var(--sar-upload-preview-bg);
  cursor: pointer;

  @at-root {
    .sar-upload-image {
      display: flex;
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .sar-upload-video {
      display: flex;
      width: 100%;
      height: 100%;
      object-fit: contain;
    }

    .sar-upload-video-play {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
      pointer-events: none;
      background-color: var(--sar-upload-video-play-bg);
      color: var(--sar-upload-video-play-color);
    }

    .sar-upload-file {
      display: flex;
      width: 100%;
      height: 100%;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      color: var(--sar-upload-file-color);

      @at-root {
        .sar-upload-file-icon {
          font-size: var(--sar-upload-file-icon-font-size);
        }
        .sar-upload-file-name {
          box-sizing: border-box;
          max-width: 100%;
          padding: 0 var(--sar-upload-file-name-padding-x);
          margin-top: var(--sar-upload-file-name-margin-top);
          font-size: var(--sar-upload-file-name-font-size);
          @include ellipsis;
        }
      }
    }

    .sar-upload-status {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      z-index: 10;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      color: var(--sar-upload-status-color);
      background-color: var(--sar-upload-status-bg);

      @at-root {
        .sar-upload-status-icon {
          display: flex;
          font-size: var(--sar-upload-status-icon-font-size);
        }
        .sar-upload-status-message {
          box-sizing: border-box;
          max-width: 100%;
          padding: 0 var(--sar-upload-status-message-padding-x);
          margin-top: var(--sar-upload-status-message-margin-top);
          font-size: var(--sar-upload-status-message-font-size);
          @include ellipsis;
        }
      }

      .sar-upload-loading {
        width: var(--sar-upload-loading-size);
        height: var(--sar-upload-loading-size);
        color: inherit;
      }
    }

    .sar-upload-remove {
      position: absolute;
      top: 0;
      right: 0;
      z-index: 20;
      width: auto;
      cursor: pointer;

      @include button-flush;

      @at-root {
        .sar-upload-close {
          margin-right: var(--sar-upload-close-right);
          margin-top: var(--sar-upload-close-top);
          display: flex;
          align-items: center;
          justify-content: center;
          width: var(--sar-upload-close-width);
          height: var(--sar-upload-close-height);
          font-size: var(--sar-upload-close-font-size);
          border-radius: 50%;
          color: var(--sar-upload-close-color);
          background-color: var(--sar-upload-close-bg);
        }
      }
    }
  }
}

.sar-upload-select {
  position: relative;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  width: var(--sar-upload-select-width);
  height: var(--sar-upload-select-height);
  font-size: var(--sar-upload-select-font-size);
  color: var(--sar-upload-select-color);
  border-radius: var(--sar-upload-select-border-radius);
  background-color: var(--sar-upload-select-bg);
  cursor: pointer;

  .sar-upload:not(.sar-upload-disabled) &:active {
    background-color: var(--sar-upload-select-active-bg);
  }

  .sar-upload-disabled & {
    @include disabled;
  }

  @at-root {
    .sar-upload-input {
      position: absolute;
      top: 0;
      left: 0;
      z-index: 2;
      width: 100%;
      height: 100%;
      overflow: hidden;
      opacity: 0;
      cursor: pointer;
    }
  }
}
